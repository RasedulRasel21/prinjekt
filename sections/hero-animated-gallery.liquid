{% comment %}
  Section: 3D Print Hero with Animated Gallery
  File: sections/hero-animated-gallery.liquid
{% endcomment %}

{{ 'hero-animated-gallery.css' | asset_url | stylesheet_tag }}


<div class="hero-animated-section">
  <div class="hero-container">
    <div class="hero-content">
      <div class="hero-text">
        {% if section.settings.heading != blank %}
          <h1 class="hero-heading">{{ section.settings.heading }}</h1>
        {% endif %}
        
        {% if section.settings.description != blank %}
          <p class="hero-description">{{ section.settings.description }}</p>
        {% endif %}
        
        {% if section.settings.button_text != blank %}
          <a href="{{ section.settings.button_link }}" class="hero-button">
            {{ section.settings.button_text }}
          </a>
        {% endif %}
      </div>
      
      <div class="hero-image-container">
        <div class="animated-image-wrapper" id="animatedImage">
          {% if section.settings.hero_image != blank %}
            <img 
              src="{{ section.settings.hero_image | img_url: 'master' }}" 
              alt="{{ section.settings.hero_image.alt | escape }}"
              class="hero-image"
            >
          {% else %}
            <div class="image-placeholder">
              {{ 'lifestyle-1' | placeholder_svg_tag: 'placeholder-svg' }}
            </div>
          {% endif %}
        </div>
      </div>
    </div>
  </div>
</div>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    const imageWrapper = document.getElementById('animatedImage');
    if (!imageWrapper) return;

    // Animation parameters from settings
    const xSpeed       = {{ section.settings.horizontal_speed | default: 3 }} * 0.4;
    const ySpeed       = {{ section.settings.vertical_speed   | default: 2 }} * 0.4;
    const rotSpeed     = {{ section.settings.rotation_speed   | default: 1 }} * 0.4;
    const scaleSpeed   = {{ section.settings.scale_speed      | default: 1 }} * 0.4;

    const maxXOffset   = {{ section.settings.max_horizontal_offset | default: 40 }};
    const maxYOffset   = {{ section.settings.max_vertical_offset   | default: 30 }};
    const maxRotation  = {{ section.settings.max_rotation          | default: 3 }};
    const minScale     = {{ section.settings.min_scale             | default: 95 }} / 100;
    const maxScale     = {{ section.settings.max_scale             | default: 105 }} / 100;

    const baseScale    = (minScale + maxScale) / 2;
    const scaleRange   = (maxScale - minScale) / 2;

    let isPaused  = false;
    let startTime = null;

    function animate(timestamp) {
      if (!startTime) startTime = timestamp;

      if (!isPaused) {
        const t = (timestamp - startTime) / 1000; // seconds

        // Smooth floating movement
        const x = Math.sin(t * xSpeed) * maxXOffset;
        const y = Math.cos(t * ySpeed) * maxYOffset;

        // Gentle rocking rotation
        const r = Math.sin(t * rotSpeed) * maxRotation;

        // Subtle breathing scale (very soft)
        const s = baseScale + Math.sin(t * scaleSpeed) * scaleRange;

        imageWrapper.style.transform =
          'translate3d(' + x + 'px,' + y + 'px,0) rotate(' + r + 'deg) scale(' + s + ')';
      }

      requestAnimationFrame(animate);
    }

    // Start animation
    requestAnimationFrame(animate);

    // Pause on hover
    imageWrapper.addEventListener('mouseenter', function() {
      isPaused = true;
    });

    imageWrapper.addEventListener('mouseleave', function() {
      isPaused = false;
    });
  });
</script>


{% schema %}
{
  "name": "Hero Animated Gallery",
  "settings": [
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "Der passende Druck für Ihre Firma!"
    },
    {
      "type": "textarea",
      "id": "description",
      "label": "Description",
      "default": "Bei uns steht der Kunde im Mittelpunkt – wir fertigen für jeden den passenden Druck an. Ob Sie ein Unternehmen sind, das präzise Bauteile benötigt, oder ein Privatkunde, der ein individuelles Design verwirklichen möchte – wir bieten maßgeschneiderte Lösungen für Ihre spezifischen Anforderungen."
    },
    {
      "type": "text",
      "id": "button_text",
      "label": "Button Text",
      "default": "Jetzt einen 3D-Druck bestellen"
    },
    {
      "type": "url",
      "id": "button_link",
      "label": "Button Link"
    },
    {
      "type": "image_picker",
      "id": "hero_image",
      "label": "Hero Image"
    },
    {
      "type": "header",
      "content": "Animation Settings"
    },
    {
      "type": "range",
      "id": "horizontal_speed",
      "label": "Horizontal Speed (Left-Right)",
      "min": 1,
      "max": 20,
      "step": 1,
      "default": 3,
      "unit": "x"
    },
    {
      "type": "range",
      "id": "vertical_speed",
      "label": "Vertical Speed (Top-Bottom)",
      "min": 1,
      "max": 20,
      "step": 1,
      "default": 2,
      "unit": "x"
    },
    {
      "type": "range",
      "id": "rotation_speed",
      "label": "Rotation Speed",
      "min": 0,
      "max": 5,
      "step": 1,
      "default": 1,
      "unit": "x"
    },
    {
      "type": "range",
      "id": "scale_speed",
      "label": "Scale Speed (Zoom)",
      "min": 0,
      "max": 10,
      "step": 1,
      "default": 1,
      "unit": "x"
    },
    {
      "type": "range",
      "id": "max_horizontal_offset",
      "label": "Max Horizontal Movement",
      "min": 10,
      "max": 100,
      "step": 5,
      "default": 40,
      "unit": "px"
    },
    {
      "type": "range",
      "id": "max_vertical_offset",
      "label": "Max Vertical Movement",
      "min": 10,
      "max": 100,
      "step": 5,
      "default": 30,
      "unit": "px"
    },
    {
      "type": "range",
      "id": "max_rotation",
      "label": "Max Rotation Angle",
      "min": 0,
      "max": 10,
      "step": 1,
      "default": 3,
      "unit": "deg"
    },
    {
      "type": "range",
      "id": "min_scale",
      "label": "Minimum Scale",
      "min": 80,
      "max": 100,
      "step": 1,
      "default": 95,
      "unit": "%"
    },
    {
      "type": "range",
      "id": "max_scale",
      "label": "Maximum Scale",
      "min": 100,
      "max": 120,
      "step": 1,
      "default": 105,
      "unit": "%"
    }
  ],
  "presets": [
    {
      "name": "Hero Animated Gallery"
    }
  ]
}
{% endschema %}